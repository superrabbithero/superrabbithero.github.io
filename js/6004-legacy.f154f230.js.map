{"version":3,"file":"js/6004-legacy.f154f230.js","mappings":"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","sources":["webpack://augest/./src/components/gameDemo/theTurtleFamily.vue","webpack://augest/./src/components/gameDemo/theTurtleFamily.vue?68f4"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <canvas ref=\"mainCanvas\" width=\"470\" height=\"720\" :class=\"{'game-canvas':true, 'gridsytle':showGrid}\" ></canvas>\r\n    <div class=\"button-groups\">\r\n      <div class=\"button-item\">\r\n        <label>显示网格：</label>\r\n        <input type=\"checkbox\" v-model=\"showGrid\">\r\n      </div>\r\n      <div class=\"button-item\">\r\n        <label>动画控制：</label>\r\n        <button class=\"fill\" @click=\"startAnimate\">开始</button>\r\n        <button class=\"fill\" @click=\"stopAnimate\">停止</button>\r\n      </div>\r\n      <div class=\"button-item\">\r\n        <label>测试方法的按钮：</label>\r\n        <button class=\"fill\" @click=\"addPopo\">加兔子</button>\r\n        <button class=\"fill\" @click=\"addPigCoin\">加一个硬币</button>\r\n      </div>\r\n      <div class=\"button-item\">\r\n        <label>方向：</label>\r\n        <div class=\"dir-contorl\">\r\n          <div style=\"margin-bottom: 10px;\">\r\n            <button @click=\"startJump\"><svg-icon name=\"arrow-up\"></svg-icon></button>\r\n          </div>\r\n          <div>\r\n            <button @pointerdown=\"startMove(-1)\" @pointerup=\"stopMove\" @pointerleave=\"stopMove\"><svg-icon name=\"arrow-left\"></svg-icon></button>  \r\n            <button><svg-icon name=\"arrow-down\"></svg-icon></button>      \r\n            <button @pointerdown=\"startMove(1)\" @pointerup=\"stopMove\" @pointerleave=\"stopMove\"><svg-icon name=\"arrow-right\"></svg-icon></button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"button-item log\">\r\n        速度：{{ Math.abs(moveV.toFixed(2)) }}\r\n        log:{{ log }}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\r\n  data(){\r\n    return {\r\n      showGrid:true,\r\n      mainGameData:[],\r\n      animateId:0,\r\n      maincanvas:null,\r\n      ctx:null,\r\n      srcMap:{},\r\n      objectMap:{},\r\n      srcPath:'@/assets/game-img/test/',\r\n      startX:null,\r\n      startY:null,\r\n      jumpTime:null,\r\n      moveTime:null,\r\n      moveV:0,\r\n      moveDir:0,\r\n      \r\n      idleFrames:{},//暂时保存一下帧动画\r\n      currentIdleFrame:0,\r\n      lastIdleFrameTime:0,\r\n      idleFrameDuration: 100, \r\n\r\n      IdleIndexFlag:false,\r\n      log:'',\r\n      objectNewId:0\r\n    }\r\n  },\r\n  created(){\r\n    this.objectMap = new Map()\r\n    this.srcMap = new Map()\r\n    this.idleFrames = new Map()\r\n    this.loadAllIdleFrames();\r\n  },\r\n  mounted(){\r\n    this.init()\r\n    window.addEventListener('keydown', this.handleKeyDown)\r\n    window.addEventListener('keyup', this.handleKeyUp)\r\n  },\r\n  unmounted(){\r\n    window.removeEventListener('keydown', this.handleKeyDown)\r\n    window.removeEventListener('keyup', this.handleKeyUp)\r\n  },\r\n  methods:{\r\n    test(){\r\n      this.pushObject('user','drawing.svg',{x:50,y:320},'paopao')\r\n      this.pushObject('coin1','drawing.svg',{x:50,y:50},'pigcoin')\r\n    },\r\n    addPopo(){\r\n      this.pushObject('user','drawing.svg',{x:50,y:320},'paopao')\r\n    },\r\n    addPigCoin(){\r\n      const objectId = 'coin' + this.objectNewId++\r\n      this.log = objectId\r\n      this.pushObject(objectId,'drawing.svg',{x:(50*this.objectNewId)%600,y:50},'pigcoin')\r\n    },\r\n    handleKeyDown(event){\r\n      console.log(`down:${event.key}`)\r\n      switch(event.key){\r\n        case ' ': \r\n          this.startJump();\r\n          break;\r\n        case 'ArrowRight': \r\n          if(this.moveDir != 1)\r\n            this.startMove(1) ;\r\n          break;\r\n        case 'ArrowLeft':\r\n          if(this.moveDir != -1) \r\n            this.startMove(-1) ;\r\n          break;\r\n      }\r\n    },\r\n    handleKeyUp(event){\r\n      console.log(`up:${event.key}`)\r\n      switch(event.key){\r\n        case 'ArrowRight': \r\n          this.stopMove() ;\r\n          break;\r\n        case 'ArrowLeft': \r\n          this.stopMove() ;\r\n          break;\r\n      }\r\n    },\r\n    init(){\r\n      this.maincanvas = this.$refs.mainCanvas;\r\n      this.ctx = this.maincanvas.getContext('2d');\r\n      this.ctx.lineWidth = 1\r\n    },\r\n    startMove(dir){\r\n      this.moveTime = new Date().getTime()\r\n      this.moveDir = dir\r\n      console.log(this.moveTime, this.moveDir)\r\n    },\r\n    stopMove(){\r\n      this.moveDir = 0\r\n      console.log(this.moveTime, this.moveDir)\r\n    },\r\n    move(){\r\n      const starta = this.jumpTime ? 0 : 0.05\r\n      const fa = this.jumpTime ? 0.001 : 0.01\r\n      const maxV = 5\r\n      if(this.moveTime){\r\n        const t = ((new Date().getTime()-this.moveTime))/100\r\n        if(this.moveDir > 0){\r\n          this.moveV = this.moveV + this.moveDir*(starta - fa)*t\r\n          this.moveV = Math.min(this.moveV,maxV)\r\n          let userObject = this.objectMap.get(\"user\")\r\n          userObject.position.x += this.moveV\r\n          this.objectMap.set('user', userObject)\r\n        }else if(this.moveDir < 0){\r\n          this.moveV = this.moveV + this.moveDir*(starta - fa)*t\r\n          this.moveV = Math.max(this.moveV,-maxV)\r\n          let userObject = this.objectMap.get(\"user\")\r\n          userObject.position.x += this.moveV\r\n          \r\n          this.objectMap.set('user', userObject)\r\n        }else{\r\n          if(this.moveV > 0){\r\n            this.moveV -= fa*t\r\n            if(this.moveV < 0){\r\n              this.moveTime = null\r\n              this.moveV = 0\r\n            }else{\r\n              let userObject = this.objectMap.get(\"user\")\r\n              userObject.position.x += this.moveV\r\n              this.objectMap.set('user', userObject)\r\n            }\r\n          }else{\r\n            this.moveV += fa*t\r\n            if(this.moveV > 0){\r\n              this.moveTime = null\r\n              this.moveV = 0\r\n            }else{\r\n              let userObject = this.objectMap.get(\"user\")\r\n              userObject.position.x += this.moveV\r\n              this.objectMap.set('user', userObject)\r\n            }\r\n          }\r\n        }\r\n        \r\n\r\n      }\r\n      \r\n      \r\n    },\r\n    startJump(){\r\n      if(!this.jumpTime){\r\n        this.startY = this.objectMap.get(\"user\").position.y\r\n        this.jumpTime = new Date().getTime()\r\n      }\r\n    },\r\n    jump(){\r\n      const v = -100 //跳跃初速度\r\n      const a = 10 //重力加速度\r\n      let userObject = this.objectMap.get(\"user\")\r\n      const y1 = this.startY\r\n      const t = ((new Date().getTime()-this.jumpTime))/100\r\n      const y = y1 + v*t + a * t * t\r\n      if(y > y1){\r\n        userObject.position.y = y1\r\n        this.objectMap.set('user', userObject)\r\n        this.jumpTime = null\r\n      }else{\r\n        userObject.position.y = y\r\n        this.objectMap.set('user', userObject)\r\n      }\r\n    },\r\n\r\n    pushObject(id,url,position,name){\r\n      if(this.srcMap.has(url)){\r\n        this.objectMap.set(id,{url,position,animationName:\"idle01\",animationIndex:0,name})\r\n      }else{\r\n        this.getImage(url).then((rs)=>{\r\n          // console.log(rs)\r\n          this.objectMap.set(id,{url,position,animationName:\"idle01\",animationIndex:0,name})\r\n        }).catch((err)=>{\r\n          // console.log(err)\r\n        })\r\n      }\r\n    },\r\n    deleteObject(id){\r\n      this.objectMap.delete(id)\r\n    },\r\n    startAnimate(){\r\n      if(this.animateId == 0){\r\n        this.animateId = requestAnimationFrame(this.updateMainCanvasAnimate)\r\n      }\r\n    },\r\n    stopAnimate(){\r\n      cancelAnimationFrame(this.animateId)\r\n      this.animateId = 0\r\n    },\r\n    updateMainCanvasAnimate(timestamp){\r\n      \r\n      const userObject = this.objectMap.get('user')\r\n      const userFramesList = this.idleFrames.get(userObject.name)[userObject.animationName]\r\n      //位移必须得实时刷新\r\n      if(this.jumpTime){\r\n        this.jump()\r\n      }\r\n      this.move()\r\n        \r\n      \r\n      //刷新帧动画\r\n      if(timestamp - this.lastIdleFrameTime > this.idleFrameDuration){\r\n        this.ctx.clearRect(0,0,720,480)\r\n        \r\n        \r\n        this.objectMap.forEach((value, key) => {\r\n          const idleFramesList = this.idleFrames.get(value.name)[value.animationName]\r\n          if(value.name == 'paopao'){\r\n            this.ctx.drawImage(idleFramesList[value.animationIndex],value.position.x,value.position.y,160,160)\r\n          }else{\r\n            this.ctx.drawImage(idleFramesList[value.animationIndex],value.position.x,value.position.y,75,75)\r\n            this.log = `${value.animationIndex},${idleFramesList.length}`\r\n          }\r\n          value.animationIndex = (value.animationIndex+1)%(idleFramesList.length)\r\n          this.objectMap.set(key,value)\r\n        })\r\n        // this.IdleIndexFlag = false\r\n        this.lastIdleFrameTime = timestamp;\r\n      }\r\n        \r\n      \r\n\r\n\r\n      this.animateId = requestAnimationFrame(this.updateMainCanvasAnimate)\r\n    },\r\n    async getImage(url) {\r\n      if(url.split('.').slice(-1)[0] == 'svg'){\r\n        // 加载SVG图像\r\n        const svgResponse = await fetch(require(`@/assets/game-img/test/${url}`));\r\n        const svgText = await svgResponse.text();\r\n        const svgDoc = new DOMParser().parseFromString(svgText, \"image/svg+xml\");\r\n        const svgElement = svgDoc.querySelector('svg');\r\n        const svgData = new XMLSerializer().serializeToString(svgElement);\r\n        const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });\r\n        const svgUrl = URL.createObjectURL(svgBlob);\r\n        const svgImg = new Image();\r\n        const that = this\r\n        svgImg.onload = function() {\r\n          that.srcMap.set(url, svgImg); \r\n          URL.revokeObjectURL(svgUrl);\r\n        };\r\n        svgImg.src = svgUrl;\r\n      }else{\r\n        // 加载PNG图像\r\n        const pngImg = new Image();\r\n        const that = this\r\n        pngImg.onload = function() {\r\n          that.srcMap.set(url, pngImg) \r\n        };\r\n        pngImg.src = require(`@/assets/game-img/test/${url}`); \r\n      }\r\n    },\r\n    loadAllIdleFrames(callback) {\r\n      const context = require.context('@/assets/game-img/test/animation/', true, /\\.png$/);\r\n\r\n      context.keys().forEach((key) => {\r\n        // 使用正则表达式从路径中提取 objectName 和 animateName\r\n        const pathMatch = key.match(/\\.\\/([^/]+)\\/([^/]+)\\/.+\\.png$/);\r\n        if (pathMatch) {\r\n          const objectName = pathMatch[1];\r\n          const animateName = pathMatch[2];\r\n\r\n          if (!this.idleFrames.has(objectName)) {\r\n            this.idleFrames.set(objectName, {});\r\n          }\r\n          const objectIdles = this.idleFrames.get(objectName);\r\n          \r\n          if (!objectIdles[animateName]) {\r\n            objectIdles[animateName] = [];\r\n          }\r\n\r\n          const img = new Image();\r\n          img.onload = () => {\r\n            objectIdles[animateName].push(img);\r\n          };\r\n          img.src = context(key);\r\n\r\n          this.idleFrames.set(objectName, objectIdles);\r\n        }\r\n      });\r\n\r\n      if (callback) callback();\r\n    }\r\n\r\n  }\r\n\r\n}\r\n  \r\n</script>\r\n\r\n<style scoped>\r\n  .container{\r\n    height: calc(100vh - 125px);\r\n  }\r\n\r\n  .game-canvas{\r\n    border: var(--box-border);\r\n    width: 480px;\r\n    height: 720px;\r\n    \r\n  }\r\n\r\n  .gridsytle{\r\n    background: linear-gradient(\r\n        -45deg,\r\n        #d9d9d9 25%,\r\n        transparent 25%,\r\n        transparent 75%,\r\n        #d9d9d9 75%,\r\n        #d9d9d9 100%\r\n      ),\r\n      linear-gradient(\r\n        -45deg,\r\n        #d9d9d9 25%,\r\n        transparent 25%,\r\n        transparent 75%,\r\n        #d9d9d9 75%,\r\n        #d9d9d9 100%\r\n      );\r\n    background-size: 10px 10px;\r\n    background-position: 0px 0px, 5px 5px;\r\n    background-color: white;\r\n  }\r\n\r\n  .button-groups {\r\n    width: 720px;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    /* justify-content: center; */\r\n  }\r\n\r\n  .button-item{\r\n    margin: 10px;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .button-item.log{\r\n    width: 100%;\r\n  }\r\n  .button-item button{\r\n    margin-right:10px;\r\n  }\r\n\r\n  .dir-contorl button{\r\n    padding: 5px;\r\n  }\r\n</style>\r\n\r\n","import { render } from \"./theTurtleFamily.vue?vue&type=template&id=49f1d9ed&scoped=true\"\nimport script from \"./theTurtleFamily.vue?vue&type=script&lang=js\"\nexport * from \"./theTurtleFamily.vue?vue&type=script&lang=js\"\n\nimport \"./theTurtleFamily.vue?vue&type=style&index=0&id=49f1d9ed&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-49f1d9ed\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","style","_createElementBlock","_hoisted_1","ref","width","height","_normalizeClass","$data","showGrid","_hoisted_2","_hoisted_3","_hoisted_4","type","$event","_hoisted_5","_hoisted_6","onClick","_cache","$options","startAnimate","apply","arguments","stopAnimate","_hoisted_7","_hoisted_8","addPopo","addPigCoin","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","startJump","_createVNode","_component_svg_icon","name","onPointerdown","startMove","onPointerup","stopMove","onPointerleave","_hoisted_13","_toDisplayString","Math","abs","moveV","toFixed","log","data","mainGameData","animateId","maincanvas","ctx","srcMap","objectMap","srcPath","startX","startY","jumpTime","moveTime","moveDir","idleFrames","currentIdleFrame","lastIdleFrameTime","idleFrameDuration","IdleIndexFlag","objectNewId","created","this","Map","loadAllIdleFrames","mounted","init","window","addEventListener","handleKeyDown","handleKeyUp","unmounted","removeEventListener","methods","test","pushObject","x","y","objectId","event","console","concat","key","$refs","mainCanvas","getContext","lineWidth","dir","Date","getTime","move","starta","fa","maxV","t","min","userObject","get","position","set","max","jump","v","a","y1","id","url","_this","has","animationName","animationIndex","getImage","then","rs","catch","err","deleteObject","delete","requestAnimationFrame","updateMainCanvasAnimate","cancelAnimationFrame","timestamp","_this2","clearRect","forEach","value","idleFramesList","drawImage","length","_this3","_asyncToGenerator","_regeneratorRuntime","mark","_callee","svgResponse","svgText","svgDoc","svgElement","svgData","svgBlob","svgUrl","svgImg","that","pngImg","_that","wrap","_context","prev","next","split","slice","fetch","require","sent","text","DOMParser","parseFromString","querySelector","XMLSerializer","serializeToString","Blob","URL","createObjectURL","Image","onload","revokeObjectURL","src","stop","callback","_this4","context","keys","pathMatch","match","objectName","animateName","objectIdles","img","push","__exports__","render"],"sourceRoot":""}